machine:
  pre:
    - sudo curl -L -o /usr/bin/docker 'https://s3-external-1.amazonaws.com/circle-downloads/docker-1.9.1-circleci'
    - sudo chmod 0755 /usr/bin/docker

  services:
    - docker
 
dependencies:
  cache_directories:
    - "~/docker"
  
  override:
    - docker build -t laletscaria/simtool . :
        timeout: 21600
    - mkdir -p ~/docker; docker save "laletscaria/simtool" > ~/docker/image.tar
    
test:
  override:
    - docker run --rm -it -v $PWD:$PWD -w $PWD laletscaria/simtool ./test/test.py
